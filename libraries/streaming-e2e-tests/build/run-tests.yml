# Run Tests navigating to a React App that uses a customized DLJS
# that has latest nightly version of `botframework-streaming`

steps:
  - task: DownloadPipelineArtifact@2
    displayName: Download CustomizedReactApp
    inputs:
      artifact: CustomizedReactApp
      path: $(ReactProjectDir)
  
  - template: use-custom-dljs-in-webchat.yml
  
  - powershell: start powershell {yarn start}
    displayName: 'yarn start React App'
    workingDirectory: $(ReactProjectDir)
  
  - powershell: npm install
    displayName: 'npm install tests'
    condition: ne(variables.CacheRestored, 'true')
    workingDirectory: $(TestsDir)

  - powershell: Start-Sleep -Seconds 60
    displayName: 'Sleeping for 60 seconds to allow React App to serve...'
  
  - powershell: npm test
    displayName: 'npm test'
    workingDirectory: $(TestsDir)
