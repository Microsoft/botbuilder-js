# jobs:
#   - job: Run_Tests
    steps:
      - powershell: ps
        displayName: 'ps top of run-tests.yml'

      - task: DownloadPipelineArtifact@2
        inputs:
          artifact: ReactApp2
          path: $(ReactProjectDir)
      
      - powershell: ls $(ReactProjectDir)/node_modules/bot*
        displayName: 'Show react-app node modules that start with bot'
        workingDirectory: $(ReactProjectDir)
      
      - powershell: type $(ReactProjectDir)/package.json
        displayName: type react-app/package.json
        workingDirectory: $(ReactProjectDir)

      - powershell: | 
          Start-Job powershell {npx react-scripts start}

          Write-Host "Sleep on start"
          Start-Sleep -Seconds 90

          Write-Host "Get processes"
          ps
          
          Write-Host "Setting location to $(TestsDir)"
          Set-Location -Path "$(TestsDir)"

          Write-Host "npm install in tests directory"
          npm install

          Write-Host "npm test"
          npm test
        displayName: 'Serve react-app (npm start), opening new console'
      #   displayName: 'Serve React App and Run Tests'
        workingDirectory: $(ReactProjectDir)
      
      # - powershell: ps 
      #   displayName: get processes
      
      # - powershell: npm install
      #   displayName: 'npm install in tests directory'
      #   workingDirectory: $(TestsDir)

      # - powershell: Start-Sleep -Seconds 90;
      #   displayName: 'Allowing react-app to serve. Sleeping 90 seconds'

      # - powershell: npm test
      #   displayName: 'Run Tests: npm test'
      #   workingDirectory: $(TestsDir)
